<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Cr√©neaux Natation - Club Triathlon</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>üèä‚Äç‚ôÇÔ∏è Cr√©neaux Natation - Club Triathlon</h1>
        <nav id="nav-menu" style="display: none;">
            <span id="user-name"></span>
            <button id="logout-btn">D√©connexion</button>
        </nav>
    </header>

    <main>
        <!-- Formulaires de connexion/inscription -->
        <div id="auth-section">
            <div class="auth-container">
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">Connexion</button>
                    <button class="tab-btn" data-tab="register">Inscription</button>
                </div>

                <form id="login-form" class="auth-form active">
                    <h2>Connexion</h2>
                    <input type="email" id="login-email" placeholder="Email" required>
                    <input type="password" id="login-password" placeholder="Mot de passe" required>
                    <button type="submit">Se connecter</button>
                </form>

                <form id="register-form" class="auth-form">
                    <h2>Cr√©er un compte</h2>
                    <input type="text" id="register-prenom" placeholder="Pr√©nom" required>
                    <input type="text" id="register-nom" placeholder="Nom" required>
                    <input type="email" id="register-email" placeholder="Email" required>
                    <input type="password" id="register-password" placeholder="Mot de passe" required>
                    <select id="register-licence" required>
                        <option value="">Type de licence</option>
                        <option value="Comp√©tition">üèÜ Comp√©tition</option>
                        <option value="Loisir/Senior">üèä‚Äç‚ôÇÔ∏è Loisir/Senior</option>
                        <option value="Benjamins/Junior">üßí Benjamins/Junior</option>
                        <option value="Poussins/Pupilles">üë∂ Poussins/Pupilles</option>
                    </select>
                    <button type="submit">Cr√©er le compte</button>
                </form>
            </div>
        </div>

        <!-- Interface principale -->
        <div id="main-section" style="display: none;">
            <div class="tabs">
                <button class="main-tab-btn active" data-tab="creneaux">Cr√©neaux disponibles</button>
                <button class="main-tab-btn" data-tab="mes-inscriptions">Mes inscriptions</button>
                <button class="main-tab-btn" data-tab="mon-profil">Mon profil</button>
                <button class="main-tab-btn admin-only" data-tab="admin" style="display: none;">Administration</button>
            </div>

            <!-- Onglet Cr√©neaux -->
            <div id="creneaux-tab" class="tab-content active">
                <h2>Cr√©neaux de natation</h2>
                <div id="creneaux-list"></div>
            </div>

            <!-- Onglet Mes inscriptions -->
            <div id="mes-inscriptions-tab" class="tab-content">
                <h2>Mes inscriptions</h2>
                <div id="mes-limites-info" style="background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 style="margin: 0 0 0.25rem 0; color: #2d3748;">üìä Votre quota de s√©ances</h4>
                            <div id="quota-details" style="color: #718096; font-size: 0.9rem;">Chargement...</div>
                        </div>
                        <div id="quota-visual" style="font-size: 1.5rem;"></div>
                    </div>
                </div>
                <div id="mes-inscriptions-list"></div>
            </div>

            <!-- Onglet Mon Profil -->
            <div id="mon-profil-tab" class="tab-content">
                <h2>Mon profil</h2>
                
                <div class="profile-sections">
                    <!-- Section Informations personnelles -->
                    <div class="profile-section">
                        <h3>üìù Informations personnelles</h3>
                        <form id="profile-form">
                            <div class="form-group">
                                <label for="profile-prenom">Pr√©nom</label>
                                <input type="text" id="profile-prenom" required>
                            </div>
                            <div class="form-group">
                                <label for="profile-nom">Nom</label>
                                <input type="text" id="profile-nom" required>
                            </div>
                            <div class="form-group">
                                <label for="profile-email">Email</label>
                                <input type="email" id="profile-email" required>
                            </div>
                            <div class="form-group">
                                <label for="profile-licence">Type de licence</label>
                                <input type="text" id="profile-licence" readonly style="background: #f7fafc; color: #718096;">
                                <small style="color: #718096;">Contactez un administrateur pour modifier votre type de licence</small>
                            </div>
                            <button type="submit">Mettre √† jour mes informations</button>
                        </form>
                    </div>

                    <!-- Section Changement de mot de passe -->
                    <div class="profile-section">
                        <h3>üîí Changer mon mot de passe</h3>
                        <form id="password-form">
                            <div class="form-group">
                                <label for="current-password">Mot de passe actuel</label>
                                <input type="password" id="current-password" required>
                            </div>
                            <div class="form-group">
                                <label for="new-password">Nouveau mot de passe</label>
                                <input type="password" id="new-password" minlength="6" required>
                                <small style="color: #718096;">Minimum 6 caract√®res</small>
                            </div>
                            <div class="form-group">
                                <label for="confirm-password">Confirmer le nouveau mot de passe</label>
                                <input type="password" id="confirm-password" minlength="6" required>
                            </div>
                            <button type="submit">Changer le mot de passe</button>
                        </form>
                    </div>

                    <!-- Section Statistiques -->
                    <div class="profile-section">
                        <h3>üìä Mes statistiques</h3>
                        <div id="profile-stats" class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="stat-inscriptions">-</div>
                                <div class="stat-label">Inscriptions actives</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="stat-seances">-</div>
                                <div class="stat-label">S√©ances cette semaine</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="stat-limite">-</div>
                                <div class="stat-label">Limite hebdomadaire</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet Administration -->
            <div id="admin-tab" class="tab-content">
                <h2>Administration</h2>
                
                <!-- Indicateur de statut des m√©ta-r√®gles -->
                <div id="meta-rules-status" style="margin-bottom: 1.5rem; padding: 1rem; border-radius: 8px; border: 2px solid #e2e8f0; background: #f8fafc;">
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div id="meta-rules-indicator" style="width: 12px; height: 12px; border-radius: 50%; background: #94a3b8;"></div>
                        <span style="font-weight: 600; color: #374151;">M√©ta-r√®gles :</span>
                        <span id="meta-rules-status-text" style="color: #6b7280;">Chargement...</span>
                        <button id="refresh-meta-rules-status" style="margin-left: auto; padding: 0.25rem 0.5rem; font-size: 0.875rem; background: #e5e7eb; border: none; border-radius: 4px; cursor: pointer;">üîÑ Actualiser</button>
                    </div>
                </div>
                
                <div class="admin-tabs" style="display: flex; gap: 0.5rem; margin-bottom: 2rem; background: #f7fafc; padding: 0.5rem; border-radius: 8px;">
                    <button class="admin-tab-btn active" data-admin-tab="creneaux">Gestion des cr√©neaux</button>
                    <button class="admin-tab-btn" data-admin-tab="users">Gestion des utilisateurs</button>
                    <button class="admin-tab-btn" data-admin-tab="limites">Limites de s√©ances</button>
                    <button class="admin-tab-btn" data-admin-tab="meta-rules">M√©ta-r√®gles</button>
                </div>

                <!-- Sous-onglet Cr√©neaux -->
                <div id="admin-creneaux-section" class="admin-tab-content active">
                    <div class="admin-section">
                        <h3>Cr√©er un nouveau cr√©neau</h3>
                        <form id="create-creneau-form">
                            <input type="text" id="creneau-nom" placeholder="Nom du cr√©neau" required>
                            <select id="creneau-jour" required>
                                <option value="">Jour de la semaine</option>
                                <option value="1">Lundi</option>
                                <option value="2">Mardi</option>
                                <option value="3">Mercredi</option>
                                <option value="4">Jeudi</option>
                                <option value="5">Vendredi</option>
                                <option value="6">Samedi</option>
                                <option value="0">Dimanche</option>
                            </select>
                            <input type="time" id="creneau-debut" required>
                            <input type="time" id="creneau-fin" required>
                            <input type="number" id="creneau-capacite" placeholder="Capacit√© max" min="1" required>
                            <div style="grid-column: 1 / -1;">
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Licences autoris√©es :</label>
                                <div id="licences-checkboxes" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                                    <label><input type="checkbox" value="Comp√©tition" checked> üèÜ Comp√©tition</label>
                                    <label><input type="checkbox" value="Loisir/Senior" checked> üèä‚Äç‚ôÇÔ∏è Loisir/Senior</label>
                                    <label><input type="checkbox" value="Benjamins/Junior" checked> üßí Benjamins/Junior</label>
                                    <label><input type="checkbox" value="Poussins/Pupilles" checked> üë∂ Poussins/Pupilles</label>
                                </div>
                            </div>
                            <button type="submit">Cr√©er le cr√©neau</button>
                        </form>
                    </div>

                    <div class="admin-section">
                        <h3>Gestion des cr√©neaux</h3>
                        
                        <!-- Section de remise √† z√©ro hebdomadaire -->
                        <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 1rem; margin-bottom: 2rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h4 style="margin: 0 0 0.5rem 0; color: #856404;">üîÑ Remise √† z√©ro hebdomadaire</h4>
                                    <p style="margin: 0; color: #856404; font-size: 0.9rem;">
                                        D√©sinscrire tous les utilisateurs de tous les cr√©neaux pour commencer une nouvelle semaine
                                    </p>
                                </div>
                                <button onclick="remiseAZeroHebdomadaire()" 
                                        style="background: #dc3545; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; cursor: pointer; font-weight: 500; white-space: nowrap;">
                                    üóëÔ∏è Vider tous les cr√©neaux
                                </button>
                            </div>
                        </div>
                        
                        <div id="admin-creneaux-list"></div>
                    </div>
                </div>

                <!-- Sous-onglet Utilisateurs -->
                <div id="admin-users-section" class="admin-tab-content">
                    <div class="admin-section">
                        <h3>Gestion des utilisateurs</h3>
                        <div id="admin-users-list"></div>
                    </div>
                </div>

                <!-- Sous-onglet Limites -->
                <div id="admin-limites-section" class="admin-tab-content">
                    <div class="admin-section">
                        <h3>Limites de s√©ances par semaine</h3>
                        <p style="color: #718096; margin-bottom: 1.5rem;">
                            D√©finissez le nombre maximum de s√©ances par semaine pour chaque type de licence.
                        </p>
                        <div id="admin-limites-list"></div>
                    </div>
                </div>

                <!-- Sous-onglet M√©ta-r√®gles -->
                <div id="admin-meta-rules-section" class="admin-tab-content">
                    <div class="admin-section">
                        <h3>M√©ta-r√®gles d'inscription</h3>
                        <p style="color: #718096; margin-bottom: 1.5rem;">
                            D√©finissez des r√®gles avanc√©es qui emp√™chent certaines combinaisons d'inscriptions selon le type de licence.
                        </p>

                        <!-- Configuration globale -->
                        <div style="background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="margin-bottom: 1rem;">Configuration globale</h4>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem;">
                                    <input type="checkbox" id="meta-rules-enabled" style="transform: scale(1.2);">
                                    <span>Activer les m√©ta-r√®gles</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="meta-rules-description">Description</label>
                                <textarea id="meta-rules-description" placeholder="Description de la configuration des m√©ta-r√®gles" rows="2"></textarea>
                            </div>
                            <button onclick="updateMetaRulesConfig()" class="btn-success">Sauvegarder la configuration</button>
                        </div>

                        <!-- Cr√©ation de nouvelle r√®gle -->
                        <div style="background: #f0fff4; border: 1px solid #9ae6b4; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
                            <h4 style="margin-bottom: 1rem;">Cr√©er une nouvelle r√®gle</h4>
                            <form id="create-meta-rule-form" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label for="rule-licence-type">Type de licence</label>
                                    <select id="rule-licence-type" required>
                                        <option value="">S√©lectionner...</option>
                                        <option value="Comp√©tition">Comp√©tition</option>
                                        <option value="Loisir/Senior">Loisir/Senior</option>
                                        <option value="Benjamins/Junior">Benjamins/Junior</option>
                                        <option value="Poussins/Pupilles">Poussins/Pupilles</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="rule-jour-source">Si inscrit le</label>
                                    <select id="rule-jour-source" required>
                                        <option value="">S√©lectionner...</option>
                                        <option value="1">Lundi</option>
                                        <option value="2">Mardi</option>
                                        <option value="3">Mercredi</option>
                                        <option value="4">Jeudi</option>
                                        <option value="5">Vendredi</option>
                                        <option value="6">Samedi</option>
                                        <option value="0">Dimanche</option>
                                    </select>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>Alors interdire les jours</label>
                                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 0.5rem;">
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="1"> Lundi
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="2"> Mardi
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="3"> Mercredi
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="4"> Jeudi
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="5"> Vendredi
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="6"> Samedi
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.25rem;">
                                            <input type="checkbox" name="jours-interdits" value="0"> Dimanche
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label for="rule-description">Description de la r√®gle</label>
                                    <textarea id="rule-description" placeholder="Ex: R√©cup√©ration obligatoire apr√®s s√©ance intensive" rows="2"></textarea>
                                </div>
                                <div style="grid-column: 1 / -1;">
                                    <button type="submit" class="btn-success">Cr√©er la r√®gle</button>
                                </div>
                            </form>
                        </div>

                        <!-- Liste des r√®gles existantes -->
                        <div>
                            <h4 style="margin-bottom: 1rem;">R√®gles existantes</h4>
                            <div id="meta-rules-list"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="message" class="message"></div>

    <script src="script.js"></script>
</body>
</html>